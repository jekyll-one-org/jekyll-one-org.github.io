/*
 # -----------------------------------------------------------------------------
 # ~/assets/themes/j1/modules/translator/js/translator.js
 # Provides JS Core functions|API for J1 Module Translator
 #
 #  Product/Info:
 #  http://jekyll.one
 #
 #  Copyright (C) 2021 Juergen Adams
 #
 #  J1 Template is licensed under MIT License.
 #  See: https://github.com/jekyll-one/J1 Template/blob/master/LICENSE
 # -----------------------------------------------------------------------------
*/
"use strict";function Translator(d){var x=log4javascript.getLogger("j1.core.translator");var w="translator-modal";var q=this;var r=false;var e=new liteURL(window.location.href);var c=(e.protocol.includes("https"))?true:false;var j;var g;var u;var v;var i;var t;this.props={contentURL:"/assets/data/translator",cookieName:"j1.user.state",cookieConsentName:"j1.user.consent",cookieStorageDays:365,cookieSameSite:"Strict",cookieSecure:false,translationEnabled:false,translatorName:"google",translationLanguage:"auto",translateAllPages:true,hideSuggestionBox:true,hidePoweredBy:true,hideTopFrame:true,dialogLanguage:"content",dialogLanguages:["en","de"],dialogContainerID:"translator-modal",xhrDataElement:"",postSelectionCallback:undefined,};this.googleTranslatorLanguages={af:{name:"Afrikaans"},sq:{name:"Albanian"},ar:{name:"Arabic"},hy:{name:"Armenian"},az:{name:"Azerbaijani"},eu:{name:"Basque"},be:{name:"Belarusian"},bn:{name:"Bengali"},bg:{name:"Bulgarian"},ca:{name:"Catalan"},"zh-CN":{name:"Chinese (Simplified)"},"zh-TW":{name:"Chinese (Traditional)"},hr:{name:"Croatian"},cs:{name:"Czech"},da:{name:"Danish"},nl:{name:"Dutch"},eo:{name:"Esperanto"},et:{name:"Estonian"},tl:{name:"Filipino"},fi:{name:"Finnish"},fr:{name:"French"},gl:{name:"Galician"},ka:{name:"Georgian"},de:{name:"German"},el:{name:"Greek"},gu:{name:"Gujarati"},ht:{name:"Haitian Creole"},iw:{name:"Hebrew"},hi:{name:"Hindi"},hu:{name:"Hungarian"},is:{name:"Icelandic"},id:{name:"Indonesian"},ga:{name:"Irish"},it:{name:"Italian"},ja:{name:"Japanese"},kn:{name:"Kannada"},ko:{name:"Korean"},la:{name:"Latin"},lv:{name:"Latvian"},lt:{name:"Lithuanian"},mk:{name:"Macedonian"},ms:{name:"Malay"},mt:{name:"Maltese"},no:{name:"Norwegian"},fa:{name:"Persian"},pl:{name:"Polish"},pt:{name:"Portuguese"},ro:{name:"Romanian"},ru:{name:"Russian"},sr:{name:"Serbian"},sk:{name:"Slovak"},sl:{name:"Slovenian"},es:{name:"Spanish"},sw:{name:"Swahili"},sv:{name:"Swedish"},ta:{name:"Tamil"},te:{name:"Telugu"},th:{name:"Thai"},tr:{name:"Turkish"},uk:{name:"Ukrainian"},ur:{name:"Urdu"},vi:{name:"Vietnamese"},cy:{name:"Welsh"},yi:{name:"Yiddish"}};this.deeplTranslatorLanguages={bg:{name:"Bulgarian"},cs:{name:"Czech"},da:{name:"Danish"},de:{name:"German"},el:{name:"Greek"},es:{name:"Spanish"},en:{name:"English"},"en-us":{name:"English (American)"},"en-uk":{name:"English (British)"},et:{name:"Estonian"},ft:{name:"Finnish"},fr:{name:"French"},hu:{name:"Hungarian"},it:{name:"Italian"},ja:{name:"Japanese"},lv:{name:"Latvian"},lt:{name:"Lithuanian"},nl:{name:"Dutch"},af:{name:"Polish"},pt:{name:"Portuguese"},"pt-pt":{name:"Portuguese (Portugal)"},"pt-br":{name:"Portuguese (Brazilian)"},ro:{name:"Romanian"},ru:{name:"Russian"},sk:{name:"Slovak"},sl:{name:"Slovenian"},sv:{name:"Swedish"},zh:{name:"Chinese"},};for(var f in d){this.props[f]=d[f]}for(var f in d){this.props[f]=d[f]}if(this.props.dialogLanguage.indexOf("-")!==-1){this.props.dialogLanguage=this.props.dialogLanguage.split("-")[0]}if(!this.props.dialogLanguages.includes(this.props.dialogLanguage)){this.props.dialogLanguage=this.props.dialogLanguages[0]}this.props.xhrDataElement=this.props.xhrDataElement+"-"+this.props.dialogLanguage;this.props.cookieSecure=c;x.info("\ninitializing core module: started");x.info("\nstate: started");var h={set:function(A,C,F,B,D){var E=window.btoa(C);var y="";if(F){var z=new Date();z.setTime(z.getTime()+(F*24*60*60*1000));y="; expires="+z.toUTCString()}if(D){document.cookie=A+"="+(E||"")+y+"; Path=/; SameSite="+B+"; secure="+D+";"}else{document.cookie=A+"="+(E||"")+y+"; Path=/; SameSite="+B+";"}},get:function(z){var C=z+"=";var y=document.cookie.split(";");for(var A=0;A<y.length;A++){var E=y[A];while(E.charAt(0)===" "){E=E.substring(1,E.length)}if(E.indexOf(C)===0){var D=E.substring(C.length,E.length);var B=window.atob(D);return B}}return undefined}};var o={documentReady:function(y){if(document.readyState!=="loading"){y()}else{document.addEventListener("DOMContentLoaded",y)}}};function l(z){var A=this;var y="#"+z.selector;$.ajax({url:z.url,dataType:"json",success:function(B){MsDropdown.make(y,{byJson:{data:B[z.elm],name:z.selector,},enableAutoFilter:false})},error:function(B,D,C){x.error("\nfailed to retrieve JSON data from: "+e)}})}function n(){o.documentReady(function(){q.modal=document.getElementById(q.props.dialogContainerID);if(!q.modal){x.info("\nload consent modal");q.modal=document.createElement("div");q.modal.id=q.props.dialogContainerID;q.modal.setAttribute("class","modal fade");q.modal.setAttribute("tabindex","-1");q.modal.setAttribute("role","dialog");q.modal.setAttribute("aria-labelledby",w);document.body.append(q.modal);q.$modal=$(q.modal);if(q.props.postSelectionCallback){q.$modal.on("hidden.bs.modal",function(){q.props.postSelectionCallback()})}q.$modal.on("shown.bs.modal",function(){if(q.props.translationLanguage==="auto"){i=navigator.language||navigator.userLanguage;t=i.split("-")[0]}var z=document.getElementById("translate-source-language").msDropdown;$(".ms-options").css("max-height","10.5937rem");$("body").addClass("stop-scrolling");if(q.props.translationLanguage==="auto"){z.disabled=true}});q.$modal.on("hidden.bs.modal",function(){var z=msDropdownSourceLanguage.value.toLowerCase();var A;if(t!==z){A=JSON.parse(h.get(q.props.cookieName));A.translationLanguage=z;h.set(q.props.cookieName,JSON.stringify(A),q.props.cookieStorageDays,q.props.sameSite,q.props.secure);x.info("\nselected language: "+z);return false}$("body").removeClass("stop-scrolling")});var y=q.props.contentURL+"/index.html";$.get(y).done(function(z){x.info("\nloading consent modal: successfully");q.modal.innerHTML=z;q.modal.innerHTML=$("#"+q.props.xhrDataElement).eq(0).html();$(q.modal).modal({backdrop:"static",keyboard:false});q.$buttonDoNotAgree=$("#translator-buttonDoNotAgree");q.$buttonAgree=$("#translator-buttonAgree");q.$buttonSave=$("#translator-buttonSave");q.$buttonAgreeAll=$("#translator-buttonAgreeAll");x.info("\nload/initialze options from cookie");m();k();$("#google-options").on("hide.bs.collapse",function(){r=false;m()}).on("show.bs.collapse",function(){r=true;m()});x.info("\ninitialze button event handler");q.$buttonDoNotAgree.click(function(){b()});q.$buttonAgree.click(function(){p()});q.$buttonSave.click(function(){$("#google-options").collapse("hide");s();k()});q.$buttonAgreeAll.click(function(){$("#google-options").collapse("hide");p()})}).fail(function(){x.error("\nloading translator dialog (modal): failed");x.warn("\nprobably no|wrong `contentURL` set")})}else{q.$modal.modal("show")}}.bind(this))}function k(){var A=q.getSettings();if(A){for(var z in A){var y=q.$modal.find("#google-options .translator-option[data-name="+z+'] input[type="checkbox"]');y.prop("checked",A[z])}}}function m(){if(r){q.$buttonDoNotAgree.hide();q.$buttonAgree.hide();q.$buttonSave.show();q.$buttonAgreeAll.show()}else{q.$buttonDoNotAgree.show();q.$buttonAgree.show();q.$buttonSave.hide();q.$buttonAgreeAll.hide()}}function a(z){var y=q.$modal.find("#google-options .translator-option");var B={};for(var C=0;C<y.length;C++){var E=y[C];var A=E.getAttribute("data-name");if(A==="necessary"){B[A]=true}else{if(z===undefined){var D=$(E).find('input[type="checkbox"]');B[A]=D.prop("checked")}else{B[A]=!!z}}}return B}function p(){var z;var y={};z=a();y=JSON.parse(h.get(q.props.cookieConsentName));y.analysis=z.analysis;y.personalization=z.personalization;h.set(q.props.cookieConsentName,JSON.stringify(y),q.props.cookieStorageDays,q.props.sameSite,q.props.secure);h.set(q.props.cookieName,JSON.stringify(a(true)),q.props.cookieStorageDays,q.props.sameSite,q.props.secure);q.$modal.modal("hide")}function b(){var y=a();y.translationEnabled=false;h.set(q.props.cookieName,JSON.stringify(y),q.props.cookieStorageDays,q.props.sameSite,q.props.secure);q.$modal.modal("hide")}function s(){var z;var y={};z=a();y=JSON.parse(h.get(q.props.cookieConsentName));y.analysis=z.analysis;y.personalization=z.personalization;h.set(q.props.cookieConsentName,JSON.stringify(y),q.props.cookieStorageDays,q.props.sameSite,q.props.secure);h.set(q.props.cookieName,JSON.stringify(a()),q.props.cookieStorageDays,q.props.sameSite,q.props.secure);q.$modal.modal("hide")}this.showDialog=function(){n()};this.getSettings=function(z){var y=h.get(q.props.cookieName);if(y){var A=JSON.parse(h.get(q.props.cookieName));if(z===undefined){return A}else{if(A){return A[z]}else{return false}}}else{return undefined}};x.info("\ninitializing core module finished");x.info("\nstate: finished")};
