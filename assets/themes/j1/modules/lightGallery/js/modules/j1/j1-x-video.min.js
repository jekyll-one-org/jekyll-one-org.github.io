/*! lg-video - v1.2.1 - 2020-03-28
* based on lg-video v1.2.0 of 2017-11-16
* Extended version to support YouPorn
* http://sachinchoolur.github.io/lightGallery
* Copyright (C) 2017 Sachin N; Licensed GPLv3 */

(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery"],function(c){return(b(c))})}else{if(typeof exports==="object"){module.exports=b(require("jquery"))}else{b(jQuery)}}}(this,function(a){(function(){var f={videoMaxWidth:"855px",autoplayFirstVideo:true,youtubePlayerParams:false,tiktokPlayerParams:false,youpornPlayerParams:false,vimeoPlayerParams:false,dailymotionPlayerParams:false,vkPlayerParams:false,videojs:false,videojsOptions:{}};var c=function(g){this.core=a(g).data("lightGallery");this.$el=a(g);this.core.s=a.extend({},f,this.core.s);this.videoLoaded=false;this.init();return this};c.prototype.init=function(){var g=this;g.core.$el.on("hasVideo.lg.tm",e.bind(this));g.core.$el.on("onAferAppendSlide.lg.tm",b.bind(this));if(g.core.doCss()&&(g.core.$items.length>1)&&(g.core.s.enableSwipe||g.core.s.enableDrag)){g.core.$el.on("onSlideClick.lg.tm",function(){var h=g.core.$slide.eq(g.core.index);g.loadVideoOnclick(h)})}else{g.core.$slide.on("click.lg",function(){g.loadVideoOnclick(a(this))})}g.core.$el.on("onBeforeSlide.lg.tm",d.bind(this));g.core.$el.on("onAfterSlide.lg.tm",function(i,h){g.core.$slide.eq(h).removeClass("lg-video-playing")})};c.prototype.loadVideo=function(h,s,q,r,p){var j="";var m=1;var t="";var g=this.core.isVideo(h,r)||{};var o;if(q){if(this.videoLoaded){m=0}else{m=this.core.s.autoplayFirstVideo?1:0}}if(g.youtube){var o=false;t="?wmode=opaque&autoplay="+m+"&enablejsapi=1";var u=this.core.$items[r].dataset.options;if(u!=="undefined"&&u.length){u=u.replace(/ /g,"");var i=u.split(",");var n=i.reduce(function(x,w){let[k,v]=w.split(":");x[k]=v;return x},{});o=n}if(this.core.s.youtubePlayerParams){t=t+"&"+a.param(this.core.s.youtubePlayerParams)}else{if(o){t=t+"&"+a.param(o)}}j='<iframe class="lg-video-object lg-youtube '+s+'" width="560" height="315" src="//www.youtube.com/embed/'+g.youtube[1]+t+'" frameborder="0" allowfullscreen></iframe>'}else{if(g.tiktok){t="?wmode=opaque&autoplay="+m+"&enablejsapi=1";j='<iframe class="lg-video-object lg-tiktok '+s+'" height="700" width="340" src="https://www.tiktok.com/embed/'+g.tiktok[2]+'" frameborder="0" scrolling="no" allow="allowfullscreen"></iframe>'}else{if(g.youporn){t="?wmode=opaque&autoplay="+m+"&enablejsapi=1";if(this.core.s.youtubePlayerParams){t=t+"&"+a.param(this.core.s.youtubePlayerParams)}j='<iframe class="lg-video-object lg-youtube '+s+'" width="560" height="315"  src="https://www.youporn.com/embed/'+g.youporn[1]+t+'" frameborder="0" scrolling=no allowfullscreen name="yp_embed_video" frameborder="0"></iframe>'}else{if(g.vimeo){t="?autoplay="+m+"&api=1";if(this.core.s.vimeoPlayerParams){t=t+"&"+a.param(this.core.s.vimeoPlayerParams)}j='<iframe class="lg-video-object lg-vimeo '+s+'" width="560" height="315"  src="//player.vimeo.com/video/'+g.vimeo[1]+t+'" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>'}else{if(g.dailymotion){t="?wmode=opaque&autoplay="+m+"&api=postMessage";if(this.core.s.dailymotionPlayerParams){t=t+"&"+a.param(this.core.s.dailymotionPlayerParams)}j='<iframe class="lg-video-object lg-dailymotion '+s+'" width="560" height="315" src="//www.dailymotion.com/embed/video/'+g.dailymotion[1]+t+'" frameborder="0" allowfullscreen></iframe>'}else{if(g.html5){var l=p.substring(0,1);if(l==="."||l==="#"){p=a(p).html()}j=p}else{if(g.vk){t="&autoplay="+m;if(this.core.s.vkPlayerParams){t=t+"&"+a.param(this.core.s.vkPlayerParams)}j='<iframe class="lg-video-object lg-vk '+s+'" width="560" height="315" src="http://vk.com/video_ext.php?'+g.vk[1]+t+'" frameborder="0" allowfullscreen></iframe>'}}}}}}}return j};c.prototype.loadVideoOnclick=function(r){var n=this;if(r.find(".lg-object").hasClass("lg-has-poster")&&r.find(".lg-object").is(":visible")){if(!r.hasClass("lg-has-video")){r.addClass("lg-video-playing lg-has-video");var l;var j;var q=function(u,s){r.find(".lg-video").append(n.loadVideo(u,"",false,n.core.index,s));if(s){if(n.core.s.videojs){try{videojs(n.core.$slide.eq(n.core.index).find(".lg-html5").get(0),n.core.s.videojsOptions,function(){this.play()})}catch(t){console.error("Make sure you have included videojs")}}else{n.core.$slide.eq(n.core.index).find(".lg-html5").get(0).play()}}};if(n.core.s.dynamic){l=n.core.s.dynamicEl[n.core.index].src;j=n.core.s.dynamicEl[n.core.index].html;q(l,j)}else{l=n.core.$items.eq(n.core.index).attr("href")||n.core.$items.eq(n.core.index).attr("data-src");j=n.core.$items.eq(n.core.index).attr("data-html");q(l,j)}var i=r.find(".lg-object");r.find(".lg-video").append(i);if(!r.find(".lg-video-object").hasClass("lg-html5")){r.removeClass("lg-complete");r.find(".lg-video-object").on("load.lg error.lg",function(){r.addClass("lg-complete")})}}else{var p=r.find(".lg-youtube").get(0);var m=r.find(".lg-vimeo").get(0);var h=r.find(".lg-dailymotion").get(0);var g=r.find(".lg-html5").get(0);if(p){p.contentWindow.postMessage('{"event":"command","func":"playVideo","args":""}',"*")}else{if(m){try{$f(m).api("play")}catch(o){console.error("Make sure you have included froogaloop2 js")}}else{if(h){h.contentWindow.postMessage("play","*")}else{if(g){if(n.core.s.videojs){try{videojs(g).play()}catch(o){console.error("Make sure you have included videojs")}}else{g.play()}}}}}r.addClass("lg-video-playing")}}};c.prototype.destroy=function(){this.videoLoaded=false};function e(i,g,l,h){var m=this;m.core.$slide.eq(g).find(".lg-video").append(m.loadVideo(l,"lg-object",true,g,h));if(h){if(m.core.s.videojs){try{videojs(m.core.$slide.eq(g).find(".lg-html5").get(0),m.core.s.videojsOptions,function(){if(!m.videoLoaded&&m.core.s.autoplayFirstVideo){this.play()}})}catch(j){console.error("Make sure you have included videojs")}}else{if(!m.videoLoaded&&m.core.s.autoplayFirstVideo){m.core.$slide.eq(g).find(".lg-html5").get(0).play()}}}}function b(h,g){var i=this.core.$slide.eq(g).find(".lg-video-cont");if(!i.hasClass("lg-has-iframe")){i.css("max-width",this.core.s.videoMaxWidth);this.videoLoaded=true}}function d(h,m,p){var o=this;var s=o.core.$slide.eq(m);var r=s.find(".lg-youtube").get(0);var n=s.find(".lg-vimeo").get(0);var i=s.find(".lg-dailymotion").get(0);var t=s.find(".lg-vk").get(0);var g=s.find(".lg-html5").get(0);if(r){r.contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}',"*")}else{if(n){try{$f(n).api("pause")}catch(q){console.error("Make sure you have included froogaloop2 js")}}else{if(i){i.contentWindow.postMessage("pause","*")}else{if(g){if(o.core.s.videojs){try{videojs(g).pause()}catch(q){console.error("Make sure you have included videojs")}}else{g.pause()}}}}}if(t){a(t).attr("src",a(t).attr("src").replace("&autoplay","&noplay"))}var l;if(o.core.s.dynamic){l=o.core.s.dynamicEl[p].src}else{l=o.core.$items.eq(p).attr("href")||o.core.$items.eq(p).attr("data-src")}var j=o.core.isVideo(l,p)||{};if(j.youtube||j.tiktok||j.youporn||j.vimeo||j.dailymotion||j.vk){o.core.$outer.addClass("lg-hide-download")}}a.fn.lightGallery.modules.video=c})()}));
