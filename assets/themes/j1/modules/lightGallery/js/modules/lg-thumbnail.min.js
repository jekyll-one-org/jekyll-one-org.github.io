/*! lg-thumbnail - v1.1.0 - 2017-08-08
* http://sachinchoolur.github.io/lightGallery
* Copyright (c) 2017 Sachin N; Licensed GPLv3 */
/*! lg-thumbnail - v1.1.0 - 2017-08-08
* http://sachinchoolur.github.io/lightGallery
* Copyright (c) 2017 Sachin N; Licensed GPLv3 */
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery"],function(c){return(b(c))})}else{if(typeof exports==="object"){module.exports=b(require("jquery"))}else{b(jQuery)}}}(this,function(a){(function(){var b={thumbnail:true,animateThumb:true,currentPagerPosition:"middle",thumbWidth:100,thumbHeight:"80px",thumbContHeight:100,thumbMargin:5,exThumbImage:false,showThumbByDefault:true,toogleThumb:true,pullCaptionUp:true,enableThumbDrag:true,enableThumbSwipe:true,swipeThreshold:50,loadYoutubeThumbnail:true,youtubeThumbSize:1,loadVimeoThumbnail:true,vimeoThumbSize:"thumbnail_small",loadDailymotionThumbnail:true};var c=function(d){this.core=a(d).data("lightGallery");this.core.s=a.extend({},b,this.core.s);this.$el=a(d);this.$thumbOuter=null;this.thumbOuterWidth=0;this.thumbTotalWidth=(this.core.$items.length*(this.core.s.thumbWidth+this.core.s.thumbMargin));this.thumbIndex=this.core.index;if(this.core.s.animateThumb){this.core.s.thumbHeight="100%"}this.left=0;this.init();return this};c.prototype.init=function(){var d=this;if(this.core.s.thumbnail&&this.core.$items.length>1){if(this.core.s.showThumbByDefault){setTimeout(function(){d.core.$outer.addClass("lg-thumb-open")},700)}if(this.core.s.pullCaptionUp){this.core.$outer.addClass("lg-pull-caption-up")}this.build();if(this.core.s.animateThumb&&this.core.doCss()){if(this.core.s.enableThumbDrag){this.enableThumbDrag()}if(this.core.s.enableThumbSwipe){this.enableThumbSwipe()}this.thumbClickable=false}else{this.thumbClickable=true}this.toogle();this.thumbkeyPress()}};c.prototype.build=function(){var k=this;var g="";var d="";var j;var f='<div class="lg-thumb-outer"><div class="lg-thumb lg-group"></div></div>';switch(this.core.s.vimeoThumbSize){case"thumbnail_large":d="640";break;case"thumbnail_medium":d="200x150";break;case"thumbnail_small":d="100x75"}k.core.$outer.addClass("lg-has-thumb");k.core.$outer.find(".lg").append(f);k.$thumbOuter=k.core.$outer.find(".lg-thumb-outer");k.thumbOuterWidth=k.$thumbOuter.width();if(k.core.s.animateThumb){k.core.$outer.find(".lg-thumb").css({width:k.thumbTotalWidth+"px",position:"relative"})}if(this.core.s.animateThumb){k.$thumbOuter.css("height",k.core.s.thumbContHeight+"px")}function h(p,i,l){var n=k.core.isVideo(p,l)||{};var o;var m="";if(n.youtube||n.vimeo||n.dailymotion){if(n.youtube){if(k.core.s.loadYoutubeThumbnail){o=i}else{o=i}}else{if(n.vimeo){if(k.core.s.loadVimeoThumbnail){o=i}else{o=i}}else{if(n.dailymotion){if(k.core.s.loadDailymotionThumbnail){o=i}else{o=i}}}}}else{o=i}g+='<div class="lg-thumb-item" style="width:'+k.core.s.thumbWidth+"px; height: "+k.core.s.thumbHeight+"; margin-right: "+k.core.s.thumbMargin+'px"><img src="'+o+'" /></div>';m=""}if(k.core.s.dynamic){for(var e=0;e<k.core.s.dynamicEl.length;e++){h(k.core.s.dynamicEl[e].src,k.core.s.dynamicEl[e].thumb,e,null)}}else{k.core.$items.each(function(l){if(!k.core.s.exThumbImage){h(a(this).attr("href")||a(this).attr("data-src"),a(this).find("img").attr("src"),l)}else{h(a(this).attr("href")||a(this).attr("data-src"),a(this).attr(k.core.s.exThumbImage),l)}})}k.core.$outer.find(".lg-thumb").html(g);j=k.core.$outer.find(".lg-thumb-item");j.each(function(){var l=a(this);var i=l.attr("data-vimeo-id");if(i){a.getJSON("//www.vimeo.com/api/v2/video/"+i+".json?callback=?",{format:"json"},function(m){l.find("img").attr("src",m[0][k.core.s.vimeoThumbSize])})}});j.eq(k.core.index).addClass("active");k.core.$el.on("onBeforeSlide.lg.tm",function(){j.removeClass("active");j.eq(k.core.index).addClass("active")});j.on("click.lg touchend.lg",function(){var i=a(this);setTimeout(function(){if((k.thumbClickable&&!k.core.lgBusy)||!k.core.doCss()){k.core.index=i.index();k.core.slide(k.core.index,false,true,false)}},50)});k.core.$el.on("onBeforeSlide.lg.tm",function(){k.animateThumb(k.core.index)});a(window).on("resize.lg.thumb orientationchange.lg.thumb",function(){setTimeout(function(){k.animateThumb(k.core.index);k.thumbOuterWidth=k.$thumbOuter.width()},200)})};c.prototype.setTranslate=function(d){this.core.$outer.find(".lg-thumb").css({transform:"translate3d(-"+(d)+"px, 0px, 0px)"})};c.prototype.animateThumb=function(e){var f=this.core.$outer.find(".lg-thumb");if(this.core.s.animateThumb){var d;switch(this.core.s.currentPagerPosition){case"left":d=0;break;case"middle":d=(this.thumbOuterWidth/2)-(this.core.s.thumbWidth/2);break;case"right":d=this.thumbOuterWidth-this.core.s.thumbWidth}this.left=((this.core.s.thumbWidth+this.core.s.thumbMargin)*e-1)-d;if(this.left>(this.thumbTotalWidth-this.thumbOuterWidth)){this.left=this.thumbTotalWidth-this.thumbOuterWidth}if(this.left<0){this.left=0}if(this.core.lGalleryOn){if(!f.hasClass("on")){this.core.$outer.find(".lg-thumb").css("transition-duration",this.core.s.speed+"ms")}if(!this.core.doCss()){f.animate({left:-this.left+"px"},this.core.s.speed)}}else{if(!this.core.doCss()){f.css("left",-this.left+"px")}}this.setTranslate(this.left)}};c.prototype.enableThumbDrag=function(){var i=this;var g=0;var e=0;var d=false;var f=false;var h=0;i.$thumbOuter.addClass("lg-grab");i.core.$outer.find(".lg-thumb").on("mousedown.lg.thumb",function(j){if(i.thumbTotalWidth>i.thumbOuterWidth){j.preventDefault();g=j.pageX;d=true;i.core.$outer.scrollLeft+=1;i.core.$outer.scrollLeft-=1;i.thumbClickable=false;i.$thumbOuter.removeClass("lg-grab").addClass("lg-grabbing")}});a(window).on("mousemove.lg.thumb",function(j){if(d){h=i.left;f=true;e=j.pageX;i.$thumbOuter.addClass("lg-dragging");h=h-(e-g);if(h>(i.thumbTotalWidth-i.thumbOuterWidth)){h=i.thumbTotalWidth-i.thumbOuterWidth}if(h<0){h=0}i.setTranslate(h)}});a(window).on("mouseup.lg.thumb",function(){if(f){f=false;i.$thumbOuter.removeClass("lg-dragging");i.left=h;if(Math.abs(e-g)<i.core.s.swipeThreshold){i.thumbClickable=true}}else{i.thumbClickable=true}if(d){d=false;i.$thumbOuter.removeClass("lg-grabbing").addClass("lg-grab")}})};c.prototype.enableThumbSwipe=function(){var h=this;var f=0;var d=0;var e=false;var g=0;h.core.$outer.find(".lg-thumb").on("touchstart.lg",function(i){if(h.thumbTotalWidth>h.thumbOuterWidth){i.preventDefault();f=i.originalEvent.targetTouches[0].pageX;h.thumbClickable=false}});h.core.$outer.find(".lg-thumb").on("touchmove.lg",function(i){if(h.thumbTotalWidth>h.thumbOuterWidth){i.preventDefault();d=i.originalEvent.targetTouches[0].pageX;e=true;h.$thumbOuter.addClass("lg-dragging");g=h.left;g=g-(d-f);if(g>(h.thumbTotalWidth-h.thumbOuterWidth)){g=h.thumbTotalWidth-h.thumbOuterWidth}if(g<0){g=0}h.setTranslate(g)}});h.core.$outer.find(".lg-thumb").on("touchend.lg",function(){if(h.thumbTotalWidth>h.thumbOuterWidth){if(e){e=false;h.$thumbOuter.removeClass("lg-dragging");if(Math.abs(d-f)<h.core.s.swipeThreshold){h.thumbClickable=true}h.left=g}else{h.thumbClickable=true}}else{h.thumbClickable=true}})};c.prototype.toogle=function(){var d=this;if(d.core.s.toogleThumb){d.core.$outer.addClass("lg-can-toggle");d.$thumbOuter.append('<span class="lg-toogle-thumb lg-icon"></span>');d.core.$outer.find(".lg-toogle-thumb").on("click.lg",function(){d.core.$outer.toggleClass("lg-thumb-open")})}};c.prototype.thumbkeyPress=function(){var d=this;a(window).on("keydown.lg.thumb",function(f){if(f.keyCode===38){f.preventDefault();d.core.$outer.addClass("lg-thumb-open")}else{if(f.keyCode===40){f.preventDefault();d.core.$outer.removeClass("lg-thumb-open")}}})};c.prototype.destroy=function(){if(this.core.s.thumbnail&&this.core.$items.length>1){a(window).off("resize.lg.thumb orientationchange.lg.thumb keydown.lg.thumb");this.$thumbOuter.remove();this.core.$outer.removeClass("lg-has-thumb")}};a.fn.lightGallery.modules.Thumbnail=c})()}));
