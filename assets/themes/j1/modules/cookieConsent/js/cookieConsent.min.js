/*
 # -----------------------------------------------------------------------------
 # ~/assets/themes/j1/modules/cookieConsent/js/cookieConsent.min.js
 # Provides JS Core for J1 Module BS Cookie Consent
 #
 #  Product/Info:
 #  https://shaack.com
 #  http://jekyll.one
 #
 #  Copyright (C) 2020 Stefan Haack
 #  Copyright (C) 2021 Juergen Adams
 #
 #  bootstrap-cookie-banner is licensed under MIT License.
 #  See: https://github.com/shaack/bootstrap-cookie-banner/blob/master/LICENSE
 #  J1 Template is licensed under MIT License.
 #  See: https://github.com/jekyll-one/J1 Template/blob/master/LICENSE
 # -----------------------------------------------------------------------------
 # TODO:
 #
 # -----------------------------------------------------------------------------
 # NOTE:
 #  BS Cookie Consent is a MODIFIED version of bootstrap-cookie-banner
 #  for the use with J1 Template. This modified version cannot be used
 #  outside of J1 Template!
 # -----------------------------------------------------------------------------
*/
function CookieConsent(o){function e(o,e){for(var t=Array.prototype.slice.call(arguments,2),n=o.split("."),i=n.pop(),a=0;a<n.length;a++)e=e[n[a]];return e[i].apply(e,t)}function t(o){b.documentReady(function(){if(p.modal=document.getElementById(p.props.dialogContainerID),p.modal)p.$modal.modal("show");else{d.info("\nload consent modal"),p.modal=document.createElement("div"),p.modal.id=p.props.dialogContainerID,p.modal.setAttribute("class","modal fade"),p.modal.setAttribute("tabindex","-1"),p.modal.setAttribute("role","dialog"),p.modal.setAttribute("aria-labelledby",p.props.dialogContainerID),document.body.append(p.modal),p.$modal=$(p.modal),p.$modal.on("hidden.bs.modal",function(){e(p.props.postSelectionCallback,window)});var o=p.props.contentURL+"/index.html";$.get(o).done(function(o){d.info("\nloading consent modal: successfully"),p.modal.innerHTML=o,p.modal.innerHTML=$("#"+p.props.xhrDataElement).eq(0).html(),$(p.modal).modal({backdrop:"static",keyboard:!1}),p.$buttonDoNotAgree=$("#bccs-buttonDoNotAgree"),p.$buttonAgree=$("#bccs-buttonAgree"),p.$buttonSave=$("#bccs-buttonSave"),p.$buttonAgreeAll=$("#bccs-buttonAgreeAll"),d.info("\nload/initialze options from cookie"),i(),n(),$("#bccs-options").on("hide.bs.collapse",function(){g=!1,i()}).on("show.bs.collapse",function(){g=!0,i()}),d.info("\ninitialze event handler"),p.$buttonDoNotAgree.click(function(){r()}),p.$buttonAgree.click(function(){s()}),p.$buttonSave.click(function(){$("#bccs-options").collapse("hide"),c(),n()}),p.$buttonAgreeAll.click(function(){$("#bccs-options").collapse("hide"),s(),n()})}).fail(function(){d.error("\nloading consent modal: failed"),d.warn("\nprobably no `contentURL` set")})}}.bind(this))}function n(){var o=p.getSettings();if(o)for(var e in o){var t=p.$modal.find("#bccs-options .bccs-option[data-name='"+e+"'] input[type='checkbox']");t.prop("checked",o[e])}}function i(){g?(p.$buttonDoNotAgree.hide(),p.$buttonAgree.hide(),p.$buttonSave.show(),p.$buttonAgreeAll.show()):(p.$buttonDoNotAgree.show(),p.$buttonAgree.show(),p.$buttonSave.hide(),p.$buttonAgreeAll.hide())}function a(o){for(var e=p.$modal.find("#bccs-options .bccs-option"),t={},n=0;n<e.length;n++){var i=e[n],a=i.getAttribute("data-name");if("necessary"===a)t[a]=!0;else if(void 0===o){var s=$(i).find("input[type='checkbox']");t[a]=s.prop("checked")}else t[a]=!!o}return t}function s(){f.set(p.props.cookieName,JSON.stringify(a(!0)),p.props.cookieStorageDays,p.props.cookieSameSite,m),p.$modal.modal("hide")}function r(){f.set(p.props.cookieName,JSON.stringify(a(!1)),p.props.cookieStorageDays,p.props.cookieSameSite,m),p.$modal.modal("hide"),j1.goHome()}function c(){f.set(p.props.cookieName,JSON.stringify(a()),p.props.cookieStorageDays,p.props.cookieSameSite,m),p.$modal.modal("hide")}var l,d=log4javascript.getLogger("j1.core.bsCookieConsent"),p=this,g=!1,u=new liteURL(window.location.href),m=u.protocol.includes("https")?!0:!1;d.info("\ninitializing core module: started"),d.info("\nstate: started"),this.props={autoShowDialog:!0,dialogLanguage:"content",dialogLanguages:["en","de"],contentURL:"/assets/data/cookieconsent",cookieName:"j1.user.translate",cookieStorageDays:365,postSelectionCallback:"",whitelisted:[],xhrDataElement:"consent-data",dialogContainerID:"consent-modal",cookieSameSite:"Strict",cookieSecure:!0};for(var h in o)this.props[h]=o[h];-1!==this.props.dialogLanguage.indexOf("-")&&(this.props.dialogLanguage=this.props.dialogLanguage.split("-")[0]),this.props.dialogLanguages.includes(this.props.dialogLanguage)||(this.props.dialogLanguage=this.props.dialogLanguages[0]),this.props.xhrDataElement=this.props.xhrDataElement+"-"+this.props.dialogLanguage,this.props.cookieSecure=m;var f={set:function(o,e,t,n,i){var a=window.btoa(e),s="";if(t){var r=new Date;r.setTime(r.getTime()+24*t*60*60*1e3),s="; expires="+r.toUTCString()}i?document.cookie=o+"="+(a||"")+s+"; Path=/; cookieSameSite="+n+"; cookieSecure="+i+";":document.cookie=o+"="+(a||"")+s+"; Path=/; cookieSameSite="+n+";"},get:function(o){for(var e=o+"=",t=document.cookie.split(";"),n=0;n<t.length;n++){for(var i=t[n];" "===i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(e)){var a=i.substring(e.length,i.length),s=window.atob(a);return s}}return void 0}},b={documentReady:function(o){"loading"!==document.readyState?o():document.addEventListener("DOMContentLoaded",o)}};l=this.props.whitelisted.indexOf(window.location.pathname)>-1,void 0===f.get(this.props.cookieName)&&this.props.autoShowDialog&&!l&&t(),d.info("\ninitializing core module finished"),d.info("\nstate: finished"),this.showDialog=function(){l=this.props.whitelisted.indexOf(window.location.pathname)>-1,l||t()},this.getSettings=function(o){var e=f.get(p.props.cookieName);if(e){var t=JSON.parse(f.get(p.props.cookieName));return void 0===o?t:t?t[o]:!1}return void 0}}
