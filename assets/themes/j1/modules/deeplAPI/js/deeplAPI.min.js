/*
 # -----------------------------------------------------------------------------
 # ~/assets/themes/j1/modules/j1Deepl/js/j1deepl.min.js
 # J1 core module for j1Deepl
 #
 # Product/Info:
 # https://jekyll.one
 #
 # Copyright (C) 2023 Juergen Adams
 #
 # J1 Theme is licensed under the MIT License.
 # For details, see: https://github.com/jekyll-one-org/j1-template/blob/main/LICENSE.md
 # -----------------------------------------------------------------------------
 # NOTE: Based on https://github.com/jquery-boilerplate/jquery-boilerplate
 # See:  https://www.dotnetcurry.com/jquery/1069/authoring-jquery-plugins
 # -----------------------------------------------------------------------------
*/
!function(t,s,n,e){"use strict";var i="deeplAPI",a={api:"free",auth_key:"",source_lang:"auto",target_lang:"DE",max_chars:!1,split_sentences:"1",preserve_formatting:"0",formality:"default",tag_handling:!1,outline_detection:!0,non_splitting_tags:!1,splitting_tags:!1,ignore_tags:!1,onInit:function(){},onBeforeTranslation:function(){},onAfterTranslation:function(){}};function g(s,n){this.element=s,this.settings=t.extend({},a,n),this.settings.elementID="#"+this.element.id,this.xhr=new XMLHttpRequest,this.init(this.settings)}t.extend(g.prototype,{init:function(s){var n,e,i,a=this,g=log4javascript.getLogger("deeplAPI.init"),r="/assets/data/private.json",o=s;g.info("\ninitialize: started"),t.ajax({url:r,dataType:"text",success:function(t){n=(i=JSON.parse(e=atob(t))).translators.deepl.auth_key},error:function(t,s,n){g.error("\nfailed to retrieve JSON data from: "+r)}});var l=setInterval(function(){void 0!==n&&(o.auth_key=n,a.translate(o),g.info("\ninitialize: finished"),g.info("\ntranslate: started"),clearInterval(l))},10)},prepareXHR:function(t){"free"===t.api?this.xhr.open("POST","https://api-free.deepl.com/v2/translate",!0):"pro"===t.api?this.xhr.open("POST","https://api.deepl.com/v2/translate",!0):this.xhr.open("POST","https://api-free.deepl.com/v2/translate",!0),this.xhr.setRequestHeader("Accept","*/*"),this.xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded")},prepareText:function(t){return t.split("\n")},translate:function(s){let n=log4javascript.getLogger("deeplAPI.translate"),e=["BG","CS","DA","DE","EL","EN-GB","EN-US","EN","ES","ET","FI","FR","HU","IT","JA","LT","LV","NL","PL","PT-PT","PT-BR","PT","RO","RU","SK","SL","SV","ZH"],i=["DE","FR","IT","ES","NL","PL","PT","PT-BR","RU"],a=s.targetElement,g=t(a).length,r="Translation failed.\nReason: ",o="Translation skipped.\nReason: ";var l,h,d,u,p,f,c={};c["400"]="Bad request. Please check error message and your parameters.",c["401"]="Authorization failed. Please supply a valid DeepL-Auth-Key.",c["403"]="Forbidden. The access to the requested resource is denied, because of insufficient access rights.",c["404"]="The requested resource could not be found.",c["413"]="The request size exceeds the limit.",c["415"]="The requested entries format specified in the Accept header is not supported.",c["429"]="Too many requests. Please wait and resend your request.",c["456"]="Quota exceeded. The maximum amount of glossaries has been reached.",c["500"]="Internal server error",c["503"]="Resource currently unavailable. Try again later.",c["529"]="Too many requests. Please wait and resend your request.";var m="",x="",T="",y="";if(!g)return n.error("\ntarget element does not exists: "+a),!1;l=a.includes(".")||a.includes("#")?a.substring(1):a,"TEXTAREA"===(h=t(a).get(0).nodeName)?T=this.element.value:"P"===h&&(x=this.element,T=t(a).text()),d=T.length,s.max_char&&T.length>s.max_char&&(T=T.substring(0,s.max_char-3)+" ...",n.info("\nlimit for source text (max: "+s.max_char+") reached: "+T.length)),y=this.prepareText(T),this.prepareXHR(s);for(var v="",_=0;_<y.length;_++)v+="&text="+y[_];if(this.xhr.onload=function(){if(4===this.readyState){if(200===this.status){for(var s=JSON.parse(this.responseText),e="",i=0;i<s.translations.length;i++)e+=s.translations[i].text,e+="\n";n.info("\ntranslation: finished"),"TEXTAREA"===h?t(a).val(e):"P"===h&&t(a).text(e)}else n.error("\nAPI returned "+this.status+": "+c[this.status])}},p=this.settings.source_lang,f=this.settings.target_lang,"auto"!==this.settings.source_lang&&(this.settings.source_lang=e.indexOf(this.settings.source_lang)>-1&&this.settings.source_lang),this.settings.target_lang=e.indexOf(this.settings.target_lang)>-1&&this.settings.target_lang,!this.settings.auth_key||!this.settings.source_lang||!this.settings.target_lang)return this.settings.auth_key||(u="NO AUTH key passed.",n.error("\ninvalid option found. "+u)),this.settings.source_lang||(u="WRONG source language passed: "+p,n.error("\ninvalid option found. "+u)),this.settings.target_lang||(u="WRONG target language passed: "+f,n.error("\ninvalid option found. "+u)),"TEXTAREA"===h?t(a).val(r+u):"P"===h&&t(a).text(r+u),!1;if(!d)return u="NO text found for translation","TEXTAREA"===h?t(a).val(o+u):"P"===h&&t(a).text(o+u),n.warn("\nno text found for translation"),!1;if("default"!==this.settings.formality&&(i.indexOf(this.settings.target_lang)>-1||n.warn("\nwrong language found for formality setting: "+this.settings.target_lang),this.settings.formality=i.indexOf(this.settings.target_lang)>-1?this.settings.formality:"default"),this.settings.tag_handling){var $=this.settings.tag_handling;this.settings.tag_handling=["xml"].indexOf(this.settings.tag_handling)>-1&&this.settings.tag_handling,this.settings.tag_handling?(this.settings.non_splitting_tags=!!this.settings.non_splitting_tags&&encodeURIComponent(this.settings.non_splitting_tags),this.settings.splitting_tags=!!this.settings.splitting_tags&&encodeURIComponent(this.settings.splitting_tags),this.settings.ignore_tags=!!this.settings.ignore_tags&&encodeURIComponent(this.settings.ignore_tags)):(n.error("\ninvalid option found for tag handling : "+$),n.warn("\ndisable option: tag_handling"),this.settings.non_splitting_tags&&(n.warn("\ndisable option: "+this.settings.non_splitting_tags),this.settings.non_splitting_tags=!1),this.settings.splitting_tags&&(n.warn("\ndisable option : "+this.settings.splitting_tags),this.settings.splitting_tags=!1),this.settings.ignore_tags&&(n.warn("\ndisable option: "+this.settings.ignore_tags),this.settings.ignore_tags=!1))}else this.settings.non_splitting_tags&&(n.warn("\ninvalid option found: "+this.settings.non_splitting_tags),this.settings.non_splitting_tags=!1),this.settings.splitting_tags&&(n.warn("\ninvalid option found: "+this.settings.splitting_tags),this.settings.splitting_tags=!1),this.settings.ignore_tags&&(n.warn("\ninvalid option found: "+this.settings.ignore_tags),this.settings.ignore_tags=!1);m="auth_key="+this.settings.auth_key,m+="auto"!==this.settings.source_lang?"&source_lang="+this.settings.source_lang:"",m+="&target_lang="+this.settings.target_lang,m+="default"!==this.settings.formality?"&formality="+this.settings.formality:"",m+=this.settings.split_sentences?"&split_sentences="+this.settings.formality:"",m+=this.settings.tag_handling?"&tag_handling="+this.settings.tag_handling:"&tag_handling=0",m+=this.settings.tag_handling&&this.settings.non_splitting_tags?"&non_splitting_tags="+this.settings.non_splitting_tags:"",m+=this.settings.tag_handling&&this.settings.splitting_tags?"&splitting_tags="+this.settings.splitting_tags:"",m+=this.settings.tag_handling&&this.settings.ignore_tags?"&ignore_tags="+this.settings.ignore_tags:"",m+=v,this.xhr.send(m)}}),t.fn[i]=function(s){var n,a=arguments;return s===e||"object"==typeof s?this.each(function(){t.data(this,"plugin_"+i)||t.data(this,"plugin_"+i,new g(this,s))}):"string"==typeof s&&"_"!==s[0]&&"init"!==s?(this.each(function(){var e=t.data(this,"plugin_"+i);e instanceof g&&"function"==typeof e[s]&&(n=e[s].apply(e,Array.prototype.slice.call(a,1))),"destroy"===s&&t.data(this,"plugin_"+i,null)}),n!==e?n:this):void 0}}(jQuery,window,document);
