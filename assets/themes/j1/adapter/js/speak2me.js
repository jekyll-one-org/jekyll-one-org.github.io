

  /*
 # -----------------------------------------------------------------------------
 # ~/assets/themes/j1/adapter/js/speak2me.js
 # J1 Adapter for the speak2me module
 #
 # Product/Info:
 # https://jekyll.one
 #
 # Copyright (C) 2023, 2024 Juergen Adams
 #
 # J1 Template is licensed under the MIT License.
 # For details, see: https://github.com/jekyll-one-org/j1-template/blob/main/LICENSE.md
 # -----------------------------------------------------------------------------
 # NOTE: Wave styles defind in /assets/data/panel.html, key 'wave'
 # -----------------------------------------------------------------------------
 #  Adapter generated: 2024-01-15 03:15:22 +0100
 # -----------------------------------------------------------------------------
*/
'use strict';j1.adapter.speak2me=function(e,t){var a,s,o,i,n,r,d,l,u,p=e.getCookieNames(),m=(e.readCookie(p.user_state),/Firefox/i.test(navigator.userAgent)),c=/chrome/i.test(navigator.userAgent),_=/Edg/i.test(navigator.userAgent),k=/OPR/i.test(navigator.userAgent),b=/Avast/i.test(navigator.userAgent),v=c&&!_,g=!1,f=!1,h=[],S=t.orientation!==undefined,x=!1,w=!1,y=!1;return{init:function(t){$.extend({module_name:'j1.adapter.speak2me',generated:'2024-01-15 03:15:22 +0100'},t);a=null!=t?$.extend({},t):{},s=$.extend({},{enabled:!1,dialogContainerID:"speak2me_container",speechSelector:"main",chrome_pause_resume_cycle:5e3,mobilesDisabled:!0,browsersDisabled:[],modal:{title:"Text-2-Speech Control",settings:{voice_settings_title:"Voice Settings",voice_select_title:"Select a voice",voice_control_title:"Voice Control",speak_button_text:"Speak",speak_button_style:"success",stop_button_text:"Stop",stop_button_style:"danger",pause_button_text:"Pause",pause_button_style:"warning",resume_button_text:"Resume",resume_button_style:"info",exit_button_text:"Close",exit_button_style:"primary",voice_speed_min:.1,voice_speed_max:3,voice_speed_step:.1,voice_speed_value:1,voice_speed_label:"Speed",voice_speed_max_label:1,voice_pitch_min:.1,voice_pitch_max:2,voice_pitch_step:.1,voice_pitch_value:.9,voice_pitch_label:"Pitch",voice_pitch_max_label:.9,voice_volume_min:0,voice_volume_max:1,voice_volume_step:.1,voice_volume_value:.9,voice_volume_label:"Volume",voice_volume_max_label:.9}}}),o=$.extend({},{enabled:!0}),i=$.extend(!0,{},s,o,a),g="false"==i.tts,f="false"==i.mobilesDisabled,h=i.browsersDisabled,r=e.adapter.speak2me,d=log4javascript.getLogger('j1.adapter.speak2me'),r.setState('started'),d.debug("\nstate: "+r.getState()),d.info("\nmodule is being initialized");var l=setInterval(function(){var t='block'==$('#no_flicker').css("display"),a='finished'==e.adapter.attic.getState();if('finished'===e.getState()&&t&&a){if(f&&S)return console.log('speak: module speak2me is disabled for mobile browsers'),$('#quickLinksSpeakButton').hide(),void clearInterval(l);if(!!h.includes('Opera')&&k)return console.log('speak: module speak2me is disabled for the Opera browser'),$('#quickLinksSpeakButton').hide(),void clearInterval(l);if(!!h.includes('Firefox')&&m)return console.log('speak: module speak2me is disabled for the Firefox browser'),$('#quickLinksSpeakButton').hide(),void clearInterval(l);if(b)return console.log('module speak2me is not supported for the Avast Secure browser'),$('#quickLinksSpeakButton').hide(),void clearInterval(l);if(g)return d.debug("\ntts detected: disabled"),$('#quickLinksSpeakButton').hide(),void clearInterval(l);(n=document.createElement('div')).id=i.dialogContainerID,n.style.display='none',n.setAttribute('class','modal fade'),n.setAttribute('tabindex','-1'),n.setAttribute('role','dialog'),n.setAttribute('aria-labelledby',i.dialogContainerID),document.body.append(n),e.loadHTML({xhr_container_id:'speak2me_container',xhr_data_path:'/assets/data/speak2me/index.html',xhr_data_element:'speak2me-modal-data'},'j1.adapter.speak2me','null'),$('#speak2me_container').on('show.bs.modal',function(){r.create('#voiceSelector')}),$('#speak2me_container').on('shown.bs.modal',function(){this.$buttonSpeak=$('#speak_button'),this.$buttonStop=$('#stop_button'),this.$buttonSpeak.click(function(){v&&(d.info("\nspeak: setup pause workaround for chromium based browsers"),u=setInterval(function(){var e=$().speak2me('isSpeaking');d.info("\nspeak: isSpeaking|isPaused: "+e+'|'+x),e?($().speak2me('pause').speak2me('resume'),d.info("\nspeak: send pause-resumed")):($().speak2me('resume'),d.info("\nspeak: send resumed"))},i.chrome_pause_resume_cycle))}),this.$buttonStop.click(function(){d.info("\nspeak: remove pause workaround for chromium based browsers"),setTimeout(function(){var e=$().speak2me('isSpeaking'),t=$().speak2me('isPaused');$('.mdib-speaker').removeClass('md-orange'),e||t||clearInterval(u)},3e3)})}),$('#speak2me_container').on('hidden.bs.modal',function(){}),r.setState('finished'),d.debug("\nstate: "+r.getState()),d.info("\nmodule initialization finished"),clearInterval(l)}},10)},create:function(e){1!=$('#voiceSelect').length&&0===$().speak2me('getVoices',e,'Select a voice')&&$(e).remove()},showDialog:function(){d.debug("\nshowDialog"),$('#speak2me_container').modal({backdrop:'static',keyboard:!1}),$('#speak2me_container').modal('show')},update:function(e,t){var a=parseFloat(t).toFixed(1);$(e).parent().find('span').text(a)},speak:function(e){var t,a=parseFloat(document.getElementById('rate').value),s=parseFloat(document.getElementById('pitch').value),o=parseFloat(document.getElementById('volume').value);$(e).speak2me('rate',a).speak2me('pitch',s).speak2me('volume',o),t=!!w;$(e).speak2me('speak',{isPaused:t,lastChunk:w,lastScrollPosition:y});$('.mdib-speaker').addClass('mdib-spin'),$('#stop_button').show(),$('#pause_button').show(),$('#speak_button').hide(),$('#resume_button').hide()},pause:function(){$('.mdib-speaker').removeClass('mdib-spin'),$('.mdib-speaker').addClass('md-orange'),v?(w=$().speak2me('isSpoken'),y=$().speak2me('isScrolled'),$().speak2me('stop')):$().speak2me('pause'),$('#resume_button').show(),$('#pause_button').hide()},resume:function(){$('.mdib-speaker').addClass('mdib-spin'),v?r.speak('main'):$().speak2me('resume'),$('#pause_button').show(),$('#resume_button').hide(),$('.mdib-speaker').removeClass('md-orange')},stop:function(){$().speak2me('stop'),$('.mdib-speaker').removeClass('mdib-spin'),$('.mdib-speaker').removeClass('md-orange'),$('#speak_button').show(),location.reload()},messageHandler:function(e,t){var a=JSON.stringify(t,undefined,2);return l="\nreceived message from "+e+': '+a,d.debug(l),'command'===t.type&&'module_initialized'===t.action&&d.info('\n'+t.text),!0},setState:function(e){r.state=e},getState:function(){return r.state}}}(j1,window);


